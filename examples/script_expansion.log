{'table_name': 'CUSTOMER', 'discrepancies': 'No discrepancies found.', 'expanded_scripts': {'/Users/shashank.singh/Documents/mycode/PolarisEAP/AUTODEPLOY/DW_MAPPER_DEFAULT/nw_customer/nw_customer_PRE_449.hql': "SET NamesList = 'na,xx,customer,refused,a,unknown';\nSET PhoneList = '0,0000000000,9999999999,1111111111,2222222222,3333333333,4444444444,5555555555,6666666666,7777777777,8888888888';\nSET EmailList = 'helloimlexa9@gmail.com,na@na.com,no@no.com,guildford-showroom@lululemon.com,1@1.com,123@gmail.com,12oaks-store@lululemon.com,22@gmail.com,29thstreet-store@lululemon.com,4thstreet-store@lululemon.com,900michigan-store@lululemon.com,900n-store@lululemon.com,abc@gmail.com,abc@yahoo.com,adelaide-store@lululemon.com,akron-showroom@lululemon.com,alamaona.store@lululemon.com,alamoana-store@lululemon.com,albuquerque-showroom@lululemon.com,alderwoodmall-store@lululemon.com,alpharetta-store@lululemon.com,annapolis-store@lululemon.com,annarbor_store@lululemon.com,annarbor-showroom@lululemon.com,annarbor-store@lululemon.com,applecross-store@lululemon.com,ardenfair-store@lululemon.com,asheville-showroom@lululemon.com,aspen_popupstore@lululemon.com,aspen_store@lululemon.com,aspen-popupstore@lululemon.com,aspen-popupstore@lululemon.con,aspen-store@lululemon.com,austin_store@lululemon.com,austin-store@lululemon.com,avalon-popup@lululemon.com,aventura-store@lululemon.com,baltimore-showroom@lululemon.com,banff-store@lululemon.com,bartoncreek-store@lululemon.com,batonrouge-showroom@lululemon.com,bellevue-store@lululemon.com,berkeley-store@lululemon.com,bernard-store@lululemon.com,bethesda-store@lululemon.com,bethesda-store@lululemon.con,billtmore-store@lululemon.com,biltmore-store@lululemon.com,birkdale-store@lululemon.com,birmingham-store@lululemon.com,bloomfieldave-store@lululemon.com,bocatowncenter-store@lululemon.com,boise-showroom@lululemon.com,bondi-store@lululemon.com,brentwood-store@lululemon.com,bretonvillage-store@lululemon.com,bridgeport-store@lululemon.com,bridgewater-store@lululemon.com,brighton-store@lululemon.com,brintonlake-store@lululemon.com,brookfieldpl-store@lululemon.com,brooklyn-store@lululemon.com,bucktown-store@lululemon.com,buffalo-showroom@lululemon.com,buingame-store@lululemon.com,burlingame-store@lululemon.com,burlington-showroom@lululemon.com,burlingtonmall-store@lululemon.com,burnside-store@lululemon.com,calabasas-store@lululemon.com,camberwell-store@lululemon.com,canberra-store@lululemon.com,carindale-store@lululemon.com,carlsbad-store@lululemon.com,carmel-showroom@lululemon.com,carrefourlaval-store@lululemon.com,center1-store@lululemon.com,center1@lululemon.com,center1store@lululemon.com,chadnler-store@lululemon.com,chadstone-store@lululemon.com,chanbdler-store@lululemon.com,chander-store@lululemon.com,chandl-store@lululemon.com,chandle-store@lululemon.com,chandler_store@lululemon.com,chandler-spring@lululemon.com,chandler-sstore@lululemon.com,chandler-store@luluemon.com,chandler-store@lululemon.co,chandler-store@lululemon.com,chandler-store@lululemonc.om,chandler.store@lululemon.com,chanlder-store@lululemon.com,chapel-store@lululemon.com,charleston-showroom@lululemon.com,charlottesville-showroom@lululemon.com,chatswoodchase-store@lululemon.com,chattanooga-showroom@lululemon.com,cherrycreek-store@lululemon.com,chestnuthill-store@lululemon.com,chinook-store@lululemon.com,chinookcentre-store@lululemon.com,chjnadler-store@lululemon.com,chnader-store@lululemon.com,chnadler-store@lululemon.com,cincinnati-showroom@lululemon.com,cityofsaskatoon,clarendon-store@lululemon.com,classencurve-store@lululemon.com,cleveland-store@lululemon.com,cloverviewplazastore@lululemon.com,coloradosprings-showroom@lululemon.com,coloradospringsstore@lululemon.com,coloradosprinsgsstore@lululemon.com,coloradosrpingsstore@lululemon.com,coquitlam-store@lululemon.com,cornwallcentre-store@lululemon.com,cortemadera-store@lululemon.com,cortemaderas-store@lululemon.com,cottesloe-store@lululemon.com,countryclubplaza-store@lululemon.com,countrymart-store@lululemon.com,cowhollow-store@lululemon.com,crescentcourt-store@lululemon.com,crocker-store@lululemon.com,crockerpark-store@lululemon.com,cumberland-store@lululemon.com,danbury-store@lululemon.com,dd@gmail.com,decline@email.com,decline@gmail.com,decline@lulu.com,decline@luluemon.com,decline@lululemoin.com,decline@lululemon.com,decline@lululwmon.com,decline@no.com,decline@yahoo.com,decline123@lululemon.com,declined@email.com,declined@gmail.com,declined@lululemon.com,declined@me.com,declined@no.com,declined@noemail.com,declined@yahoo.com,declined12@gmail.com,declined12@no.com,declined123@gmail.com,declined123@gmail.cpm,declined123@me.com,declined123@yahoo.com,declined1234@gmail.com,declined1234@me.com,declined1234@yahoo.com,declined1234646@yahoo.com,declined1236757@me.com,declined123857@gmail.com,declined126@gmail.com,declined1268352@me.com,declined128@yahoo.com,declined13@gmail.com,declined22@me.com,declined23@me.com,declined234@aol.com,declined234@gmail.com,declined234@yahoo.com,declined2345@gmail.com,declined2345@me.com,declined2345@yahoo.com,declined23458467@me.com,declined235@gmail.com,declined23583246@me.com,declined237@me.com,declined237456328@me.com,declined237565@me.com,declined238@me.com,declined2437846@me.com,declined2455@gmail.com,declined2458573@me.com,declined2468@gmail.com,declined2484673@me.com,declined24869@gmail.com,declined248693@gmail.com,declined24895@me.com,declined24957@me.com,declined2748262@gmail.com,declined274836@gmail.com,declined28563@me.com,declined285762376@me.com,declined345@me.com,declined3451@me.com,declined358276@me.com,declined358436@me.com,declined3584692@me.com,declined35876947@gmail.com,declined46987034@me.com,declined569846@yahoo.com,declined5867649@yahoo.com,declined6079847@yahoo.com,declined790472351@me.com,declinedemail@aol.com,declinedemail@yahoo.com,deerpark-store@lululemon.com,default@gmail.com,delamo-store@lululemon.com,desmoines-showroom@lululemon.com,destin-showroom@lululemon.com,destiny-store@lululemon.com,domain-store@lululemon.com,doncaster-store@lululemon.com,doncaster-store@lululemon.com.au,east66-store@lululemon.com,east66th-store@lululemon.com,easthampton-store@lululemon.com,eatoncenter-store@lululemon.com,eatoncentre-store@lululemon.ca,eatoncentre-store@lululemon.com,edinburgh-showroom@lululemon.com,ee@gmail.com,elpaso-showroom@lululemon.com,elpasoshowroom@lululemon.com,email@email.com,email@gmail.com,eton-store@lululemon.com,fairview-store@lululemon.com,farmingtonave-store@lululemon.com,fashionplace-store@lululemon.com,fashionplacestore@lululemon.com,fashionshow-store@lululemon.com,fashionvalley-store@lululemon.com,fayettevilleshowroom@lululemon.com,ff@gmail.com,figgarden_store@lululemon.com,firstcolony-store@lululemon.com,fondren-showroom@lululemon.com,fortmyers-showroom@lululemon.com,fortworth-showroom@lululemon.com,fortworth-store@lululemon.com,franklulu@gmail.com,franklulu123@gmail.com,franklulu123@lululemon.com,freehold-store@lululemon.com,friendlycenter-store@lululemon.com,frontenac-store@lululemon.com,g@gmail.com,galleriaedinastore@lululemon.com,gardencity-store@lululemon.com,gardens-store@lululemon.com,gardenstate-store@lululemon.com,gec@lululemon.com,gec@lululemon.com.au,geconline@lululemon.com,gecorders@lululemon.com,gecreturns@lululemon.com,georgetown-store@lululemon.com,gg@gmail.com,gilroy-outlet@lululemon.com,glendale-store@lululemon.com,grandave_store@lululemon.com,grandave-store@lululemon.com,grandrapids-showroom@lululemon.com,grantavenue-store@lululemon.com,greensboro-showroom@lululemon.com,greenwich-store@lululemon.com,groveatshrewsberry-store@lululemon.com,groveatshrewsbury-store@lululemon.com,halifax-store@lululemon.com,halifaxseasonalstore@lululemon.com,halsted-store@lululemon.com,harboreast-store@lululemon.com,harvardsquare-store@lululemon.com,harvardsquare.store@lululemon.com,hh@gmail.com,highlandvikllage-store@lululemon.com,highlandvillage-store@lululemon.com,highlandvillagestore@lululemon.com,highpoint-store@lululemon.com,hillcenter_store@lululemon.com,hillcenter-store@lululemon.com,hilldalemall-store@lululemon.com,hingham-store@lululemon.com,hingham.store@lululemon.com,hobart-store@lululemon.com,houstoncitycentre-store@lululemon.com,houstongalleria-store@lululemon.com,howellmill-store@lululemon.com,huntsville-showroom@lululemon.com,hydepark-showroom@lululemon.com,hydeparksquar-store@lululemon.com,hydeparksquare-store@lululemon.com,hydeparkvillage-store@lululemon.com,hylanvillage-store@lululemon.com,i@c.co,i@cloud.co,i@cloud.com,i@co.co,i@lulu.co,i@lulu.com,ifcstore@lululemon.com,info@lulu.co,info@lulu.com,info@lulu.net,info@lululemon.com,irvine-store@lululemon.com,itstoresupport@lululemon.com,ivy-store@lululemon.com,jacksonville-store@lululemon.com,jamesstreet-store@lululemon.com,johnson_store@lululemon.com,johnson-store@lululemon.com,jordancreek-store@lululemon.com,kalakaua-store@lululemon.com,karrinyup-store@lululemon.com,kaystone-store@lululemon.com,kenwood-store@lululemon.com,kenwoodstore@lululemon.com,keystone-store@lululemon.com,kingsroad-store@lululemon.com,kingstreet-store@lululemon.com,kingsway-store@lululemon.com,kitchinplace-store@lululemon.com,kitchinplace-store@lululemonc.om,knoxstreet-store@lululemon.com,kop-store@lululemon.com,lacantera-store@lululemon.com,laencantada-store@lululemon.com,laguna-showroom@lululemon.com,lajolla-store@lululemon.com,lakeshore-store@lululemon.ca,lakeshore-store@lululemon.com,leawood-store@lululemon.com,leawood-store@lululemon.ocm,legacy-store@lululemon.com,lenox-store@lululemon.com,lincolnroad-store@lululemon.com,lincolnsquare-store@lululemon.com,littlerock-store@lululemon.com,logancircle-store@lululemon.com,londonontario-store@lululemon.com,lonondontario-store@lululemon.com,louisville-showroom@lululemon.com,lulu@gmail.com,lululemon@info.com,lululemon@lululemon.com,lululemonchander@lululemon.com,lululemonchandler@lululemon.com,lululemonspringfieldave-store@lululemon.com,madisonave-store@lululemon.com,mallincolumbia-store@lululemon.com,mallofamerica-store@lululemon.com,malpleviewmall-store@lululemon.com,manhasset-store@lululemon.com,mapleview-store@lululemon.com,mapleviewmall-store@lululemon.com,marketmall-store@lululemon.com,marketstreet-store@lululemon.com,marthasvineyardpopup@lululemon.com,marylandplaza-store@lululemon.com,me@me.com,meatpacking-store@lululemon.com,merdian-store@lululemon.com,meridian-store@lululemon.com,metairie-store@lululemon.com,metroton_store@lululemon.com,metrotown-store@lululemon.com,miamibeach-showroom@lululemon.com,missionviejo-store@lululemon.com,morgancrossing-store@lululemon.com,mosaic-store@lululemon.com,mosman-store@lululemon.com,n/a,n/a@gmail.com,na@gmail.com,name@noname.com,napa-popup@lululemon.com,naples-store@lululemon.com,naples-store@lululemon.con,natick-store@lululemon.com,natickmall-store@lululemon.com,newbury-store@lululemon.com,newmarket-store@lululemon.com,neworleans-showroom@lululemon.com,neworleansshowroom@lululemon.com,newport_store@lululemon.com,newport-popup@lululemon.com,newport-store@lululemon.com,newport.store@lululemon.com,niagara-outlet@lululemon.com,no!@no.com,no.no@gmail.com,no.nol@no.com,no@123.com,no@aol.com,no@email.com,no@gmai.com,no@gmail.com,no@hotmail.com,no@live.com,no@lululemon.com,no@mail.com,no@name.com,no@noemail.com,no@nomail.com,no@thankyou.com,no@yahoo.com,noeamils@yahoo.com,noeemail@yahoo.com,noemai@gmail.com,noemai@yahoo.com,noemail!@gmai.com,noemail@aol.com,noemail@eamil.com,noemail@email.co,noemail@email.com,noemail@email.cpom,noemail@emaili.com,noemail@emial.com,noemail@gmai.com,noemail@gmaiil.com,noemail@gmail.com,noemail@gmail.copm,noemail@gmaili.com,noemail@gmal.com,noemail@hotmail.ca,noemail@hotmail.com,noemail@lululemon.com,noemail@mail.com,noemail@me.com,noemail@no.com,noemail@noemail.com,noemail@nomail.com,noemail@yaho.com,noemail@yahoo.com,noemail@yahool.com,noemail@yuahoo.com,noemail85672@me.com,noemailk@gmail.com,noemails@gmail.com,noemails@yahoo.com,noemaiol@yahoo.com,noemal@yahoo.com,noemeial@email.com,noemial@email.com,noemial@gmail.com,nogmail@gmail.com,nohotmail@hotmail.ca,noiemail@email.com,noimail@hotmail.com,nomail@ghotmail.com,nomail@gmail.com,nomail@gomail.com,nomail@hjotmail.com,nomail@hotmai.com,nomail@hotmail.com,nomail@hotmazil.com,nomail@hotymail.com,nomail@mail.com,nomasil@hotmasil.com,nomemail@gmail.com,non@none.com,noname@gmail.com,noname@hotmail.com,noname@no.com,noname@noname.com,none.none@yahoo.com,none@aol.com,none@email.com,none@gmail.com,none@no.com,none@noe.com,none@non.com,none@none.com,none@none.come,none@yahoo.com,nope@gmail.com,nope@yahoo.com,noreceipt@noreceipt.com,noreceipt@norecipt.com,norecipt@yahoo.com,noreply@apple.com,noreplyever@refused.com,northbeverly-store@lululemon.com,northbeverly-store@lululemon.comm,northbrook-store@lululemon.com,northhills-stores@lululemon.com,northpark-store@lululemon.com,nothank@gmal.com,nothanks@gmail.com,nothanks@yahoo.com,nothannks@gmail.com,oakbrook-store@lululemon.com,oakridge_store@lululemon.com,oakridge-store@lululemon.com,oldorchard-store@lululemon.com,oldorchard=store@lululemon.com,oldtown-store@lululemon.com,oldwoodwardave-store@lululemon.com,omaha-showroom@lululemon.com,online@lululemon.com,optout@optout.com,oshawa-store@lululemon.com,owasha-store@lululemon.com,oxmoorcenter-store@lululemon.com,pacificplace-store@lululemon.com,palmdesert-store@lululemon.com,paloalto-store@lululemon.com,parkcity-store@lululemon.com,parkmeadows-store@lululemon.com,parkroyal-store@lululemon.com,pasadena-store@lululemon.com,pearl-store@lululemon.com,perimeter-store@lululemon.com,perth-store@lululemon.com,placestefoy-store@lululemon.com,plazaelsegundo_store@lululemon.com,plazaelsegundo-store@lululemon.com,polaris-store@lululemon.com,polopark-store@lululemon.com,portland-showroom@lululemon.com,portsmouth-showroom@lululemon.com,princess-store@lululemon.com,princeton-store@lululemon.com,promenade-store@lululemon.com,providence-showroom@lululemon.com,prudential-store@lululemon.com,quarry-store@lululemon.com,quartierdix30-store@lululemon.com,queen-store@lululemon.com,raleigh-showroom@lululemon.com,ranchocucamonga-showroom@lululemon.com,refused@lululemon.com,regalia-store@lululemon.com,richmondcentre-store@lululemon.com,richmondthames-store@lululemon.com,rideau-store@lululemon.com,robertson-store@lululemon.com,robina-store@lululemon.com,robson-store@lululemon.com,roosevelt-store@lululemon.com,rooseveltfield-store@lululemon.com,roseville-store@lululemon.com,rossparkmall-store@lululemon.com,rush-store@lululemon.com,sagemore-store@lululemon.com,sanclemente-showroom@lululemon.com,santabarbara-store@lululemon.com,santamonica-store@lululemon.com,sarasota-store@lululemon.com,saskatoon-store@lululemon.com,savannah-showroom@lululemon.com,scarborough-store@lululemon.com,scottsdale-store@lululemon.com,scottsdalefs-store@lululemon.com,scottsdalefsstore@lululemon.com,scottsdalesfstore@lululemon.com,sfs-store@lululemon.com,shadyside-store@lululemon.com,shadyside-store@lululemon.comm,shc-showroom@lululemon.com,sherway-store@lululemon.com,shopsatcanalplace-store@lululemon.com,shopsatlegacy-store@lululemon.com,shorthills-store@lululemon.com,shortpump-store@lululemon.com,soho-store@lululemon.com,sohobroadway-store@lululemon.com,somerset-store@lululemon.com,sorrento-showroom@lululemon.com,southcentre-store@lululemon.com,southcoast-store@lululemon.com,southlake-store@lululemon.com,southmiami-store@lululemon.com,southpark-store@lululemon.com,southport-store@lululemon.com,southside-store@lululemon.com,springfieldave-store@lululemon.com,squareone-store@lululemon.com,stationpark-store@lululemon.com,stcatherine-store@lululemon.com,stdenis-store@lululemon.com,stecatherine-store@lululemon.com,stoneridgemall-store@lululemon.com,store-chandler@lululemon.com,store-chestnuthill@lululemon.com,store@lululemon.com,stpetersburgshowroom@lululemon.com,streetsatsouthpoint-store@lululemon.com,studiocity-store@lululemon.com,suburbansquare-store@lululemon.com,summerlin-showroom@lululemon.com,sunvalley-showroom@lululemon.com,syracuse-showroom@lululemon.com,syracuse-showroom@lululemon.con,tallahasse-showroom@lululemon.com,tallahassee-showroom@lululemon.com,talllahassee-showroom@lululemon.com,teamprogram@lululemon.com,temp@lululemon.com,test@test.ca,thegroveatshrewsbury-store@lululemon.com,thirdward-store@lululemon.com,toledo-showroom@lululemon.com,trolleysquare-store@lululemon.com,tsimshatsui-showroom@lululemon.com,tucson-showroom@lululemon.com,twelveoaks-store@lululemon.com,unionsquarenyc-store@lululemon.com,unknown@yahoo.com,vail-showroom@lululemon.com,vailvillage-store@lululemon.com,valencia-store@lululemon.com,vaughan-store@lululemon.com,villagepointe-store@lululemon.com,virginiabeach-store@lululemon.com,waldengalleria-store@lululemon.com,walnutcreek-store@lululemon.com,walnutstreet-store@lululemon.com,waltwhitman-store@lululemon.com,wayne-store@lululemon.com,weatfieldutc-store@lululemon.com,west4th-store@lululemon.com,westboro-store@lululemon.com,westedmall-store@lululemon.com,westend-store@lululemon.com,westfarmsmall-store@lululemon.com,westfieldmall-store@lululemon.com,westfieldutc-store@lululemon.com,westgate-outlet@lululemon.com,westlake-store@lululemon.com,westmount-store@lululemon.com,westport-store@lululemon.com,whistler-store@lululemon.com,whiteplains-store@lululemon.com,whyte-store@lululemon.com,winterpark-store@lululemon.co';\n\n\n\nINSERT INTO TABLE udm_customer\nSELECT ${columns:customer::c3.%1$s AS %1$s}\nFROM (\n    SELECT ${columns:customer:~Email,PrimaryPhone,MobilePhone,FirstName,LastName,c_researchDev,c_scStatus,SourceCustomerNumber:c2.%1$s AS %1$s}\n        , CASE \n            WHEN INSTR(LOWER(c2.Email), '@') = '0' \n                OR FIND_IN_SET(c2.Email,${hiveconf:EmailList}) > 0\n                OR c2.Email LIKE '@%'\n                OR LENGTH(c2.Email) > 100\n            THEN NULL\n            ELSE c2.Email\n          END\n          AS Email\n\n        , CASE WHEN FIND_IN_SET( PrimaryPhone, ${hiveconf:PhoneList}) > 0\n                OR LENGTH( PrimaryPhone) < 10\n                OR LENGTH( PrimaryPhone) > 13\n            THEN NULL\n            ELSE PrimaryPhone\n          END\n          AS PrimaryPhone\n\n        , CASE WHEN FIND_IN_SET( MobilePhone, ${hiveconf:PhoneList}) > 0\n                OR LENGTH( MobilePhone) < 10\n                OR LENGTH( MobilePhone) > 13\n            THEN NULL\n            ELSE MobilePhone\n          END\n          AS MobilePhone\n        ,CASE WHEN FIND_IN_SET( LOWER(c2.FirstName), ${hiveconf:NamesList}) > 0\n                OR FIND_IN_SET( LOWER(CONCAT( c2.FirstName, c2.LastName)), ${hiveconf:NamesList}) > 0\n                OR c2.FirstName NOT RLIKE '.*[A-Z]|[a-z]'\n            THEN NULL\n            ELSE InitCap( c2.FirstName)\n            END AS FirstName\n        ,CASE \n            WHEN FIND_IN_SET( LOWER(c2.LastName), ${hiveconf:NamesList}) > 0\n                OR FIND_IN_SET( LOWER(CONCAT( c2.FirstName, c2.LastName)), ${hiveconf:NamesList}) > 0\n                OR COALESCE( c2.LastName,'') NOT RLIKE '.*[A-Z]|[a-z]'\n            THEN NULL\n            ELSE InitCap( c2.LastName)\n            END AS LastName\n        ,c_researchdev\n        ,c_scStatus\n        ,CASE \n            WHEN COALESCE(LOWER(c2.SourceCustomerNumber),'') LIKE '%@%'\n            THEN REFLECT('org.apache.commons.codec.digest.DigestUtils', 'sha256Hex', LOWER(TRIM(c2.SourceCustomerNumber)))\n            ELSE  c2.SourceCustomerNumber\n          END AS SourceCustomerNumber        \n    FROM (\n        SELECT ${columns:customer:~PrimaryPhone,MobilePhone,FirstName,LastName,c_researchDev,c_scStatus:c.%1$s AS %1$s}\n            , REGEXP_REPLACE( COALESCE( PrimaryPhone, ''), '[^0-9]+', '') AS PrimaryPhone\n            , REGEXP_REPLACE( COALESCE( MobilePhone, ''), '[^0-9]+', '') AS MobilePhone\n            , COALESCE( REGEXP_REPLACE( FirstName,'\\\\s',''),'') AS FirstName\n            , COALESCE( REGEXP_REPLACE( LastName,'\\\\s',''),'') AS LastName\n            ,CASE WHEN COALESCE(LOWER(Source),'') LIKE 'customer%' \n                THEN CASE WHEN COALESCE(UPPER(c_guestType),'') LIKE '%R&D%' THEN '1' ELSE '0' END\n                ELSE NULL\n                END AS c_researchdev\n            ,CASE WHEN COALESCE(LOWER(Source),'') LIKE 'customer%' \n                THEN CASE WHEN COALESCE(UPPER(c_guestType),'') LIKE '%SWEAT_COLLECTIVE%' THEN '1' ELSE '0' END\n                ELSE NULL\n                END AS c_scStatus\n        FROM udm_s_customer c\n        WHERE COALESCE( c.SourceCustomerNumber,'') <> ''\n    ) c2\n) c3\n;", '/Users/shashank.singh/Documents/mycode/PolarisEAP/AUTODEPLOY/DW_MAPPER_DEFAULT/nw_customer/nw_customer_PRE_440.hql': 'SET GuestCheckoutSource = \'GuestCheckout\';\n\nINSERT INTO TABLE udm_customer\nSELECT ${columns:customer::c.%1$s AS %1$s}\nFROM (\n    SELECT ${columns:customer:~Email,c_lululemonSource,RowModified:stc.%1$s AS %1$s}\n        , CASE\n            WHEN COALESCE(c.SourceCustomerNumber,\'\') <> \'\' THEN c.Email\n            WHEN COALESCE(stc.Email, \'""\') = \'""\' THEN NULL\n            ELSE stc.Email\n        END AS Email\n        , CASE\n            WHEN COALESCE(c.SourceCustomerNumber, \'\') <> \'\' THEN c.c_lululemonSource\n            ELSE ${hiveconf:GuestCheckoutSource}\n        END AS c_lululemonSource\n        , stc.RowModified AS RowModified\n    FROM (\n        SELECT ${columns:customer::sc.%1$s AS %1$s}\n        FROM udm_s_customer sc\n        WHERE COALESCE(sc.c_lululemonSource, \'\') = \'\'\n        AND COALESCE(sc.sourcesystemid, \'\') = \'FTP_CSV_1\'\n    ) stc\n    LEFT OUTER JOIN (\n        SELECT c.SourceCustomerNumber AS SourceCustomerNumber\n            , c.c_lululemonSource AS c_lululemonSource\n            , SPLIT(MAX(CONCAT(CAST(c.RowModified AS STRING),\'#\',CASE WHEN COALESCE(c.email,\'""\') = \'""\' THEN NULL ELSE c.email END)),\'#\')[1] AS email\n        FROM (\n            SELECT sc.SourceCustomerNumber AS SourceCustomerNumber\n                , sc.email AS email\n                , sc.c_lululemonSource AS c_lululemonSource\n                , sc.RowModified AS RowModified\n            FROM udm_s_customer sc\n            WHERE sc.c_lululemonsource IN (\'ATG\', \'SFCC\')\n\n            UNION ALL\n\n            SELECT c.SourceCustomerNumber AS SourceCustomerNumber\n                , c.email AS email\n                , c.c_lululemonSource AS c_lululemonSource\n                , c.RowModified AS RowModified\n            FROM udm_customer c\n            WHERE c.c_lululemonsource IN (\'ATG\', \'SFCC\')\n        ) c\n        GROUP BY c.SourceCustomerNumber, c.c_lululemonSource\n    ) c\n        ON stc.SourceCustomerNumber = c.SourceCustomerNumber\n\n    UNION ALL\n\n    SELECT ${columns:customer:~Email,c_lululemonSource,RowModified:sc.%1$s AS %1$s}\n        , sc.Email AS Email\n        , sc.c_lululemonSource AS c_lululemonSource\n        , sc.RowModified + 1 AS RowModified\n    FROM udm_s_customer sc\n    WHERE COALESCE(sc.c_lululemonSource, \'\') <> \'\'\n    OR (\n        COALESCE(sc.c_lululemonSource, \'\') = \'\'\n        AND COALESCE(sc.sourcesystemid, \'\') <> \'FTP_CSV_1\'\n    )\n) c\n;', '/Users/shashank.singh/Documents/mycode/PolarisEAP/AUTODEPLOY/DW_MAPPER_DEFAULT/nw_customer/nw_customer_POST_600.hql': "INSERT INTO TABLE udm_customer\n\n\nSELECT\n\t${columns:customer::c.%1$s AS %1$s}\nFROM (\n\n\tSELECT ${columns:customer:~c_emailHash:c.%1$s AS %1$s}\n\t\t,CASE WHEN COALESCE(TRIM(Email),'') <> ''  THEN reflect('org.apache.commons.codec.digest.DigestUtils', 'sha256Hex', lower(TRIM(Email))) \n           ELSE c_emailHash \n           END AS c_emailHash\n\tFROM udm_s_customer c\n\n) c\n;", '/Users/shashank.singh/Documents/mycode/PolarisEAP/AUTODEPLOY/SF_DW_MAPPER_DEFAULT/sf_dw_customer/sf_dw_customer_PRE_449.sql': "SET NamesList = 'na,xx,customer,refused,a,unknown';\nSET PhoneList = '0,0000000000,9999999999,1111111111,2222222222,3333333333,4444444444,5555555555,6666666666,7777777777,8888888888';\ncreate or replace transient table -- ignore\ntmp_invalid_emails(email string);\ninsert overwrite into --ignore\ntmp_invalid_emails\nvalues('helloimlexa9@gmail.com'), ('na@na.com'), ('no@no.com'), ('guildford-showroom@lululemon.com'), ('1@1.com'), ('123@gmail.com'), ('12oaks-store@lululemon.com'),\n('22@gmail.com'), ('29thstreet-store@lululemon.com'), ('4thstreet-store@lululemon.com'), ('900michigan-store@lululemon.com'), ('900n-store@lululemon.com'), ('abc@gmail.com'), ('abc@yahoo.com'),\n('adelaide-store@lululemon.com'), ('akron-showroom@lululemon.com'), ('alamaona.store@lululemon.com'), ('alamoana-store@lululemon.com'), ('albuquerque-showroom@lululemon.com'), ('alderwoodmall-store@lululemon.com'), ('alpharetta-store@lululemon.com'),\n('annapolis-store@lululemon.com'), ('annarbor_store@lululemon.com'), ('annarbor-showroom@lululemon.com'), ('annarbor-store@lululemon.com'), ('applecross-store@lululemon.com'), ('ardenfair-store@lululemon.com'), ('asheville-showroom@lululemon.com'),\n('aspen_popupstore@lululemon.com'), ('aspen_store@lululemon.com'), ('aspen-popupstore@lululemon.com'), ('aspen-popupstore@lululemon.con'), ('aspen-store@lululemon.com'), ('austin_store@lululemon.com'), ('austin-store@lululemon.com'),\n('avalon-popup@lululemon.com'), ('aventura-store@lululemon.com'), ('baltimore-showroom@lululemon.com'), ('banff-store@lululemon.com'), ('bartoncreek-store@lululemon.com'), ('batonrouge-showroom@lululemon.com'), ('bellevue-store@lululemon.com'),\n('berkeley-store@lululemon.com'), ('bernard-store@lululemon.com'), ('bethesda-store@lululemon.com'), ('bethesda-store@lululemon.con'), ('billtmore-store@lululemon.com'), ('biltmore-store@lululemon.com'), ('birkdale-store@lululemon.com'),\n('birmingham-store@lululemon.com'), ('bloomfieldave-store@lululemon.com'), ('bocatowncenter-store@lululemon.com'), ('boise-showroom@lululemon.com'), ('bondi-store@lululemon.com'), ('brentwood-store@lululemon.com'), ('bretonvillage-store@lululemon.com'),\n('bridgeport-store@lululemon.com'), ('bridgewater-store@lululemon.com'), ('brighton-store@lululemon.com'), ('brintonlake-store@lululemon.com'), ('brookfieldpl-store@lululemon.com'), ('brooklyn-store@lululemon.com'), ('bucktown-store@lululemon.com'),\n('buffalo-showroom@lululemon.com'), ('buingame-store@lululemon.com'), ('burlingame-store@lululemon.com'), ('burlington-showroom@lululemon.com'), ('burlingtonmall-store@lululemon.com'), ('burnside-store@lululemon.com'), ('calabasas-store@lululemon.com'),\n('camberwell-store@lululemon.com'), ('canberra-store@lululemon.com'), ('carindale-store@lululemon.com'), ('carlsbad-store@lululemon.com'), ('carmel-showroom@lululemon.com'), ('carrefourlaval-store@lululemon.com'), ('center1-store@lululemon.com'),\n('center1@lululemon.com'), ('center1store@lululemon.com'), ('chadnler-store@lululemon.com'), ('chadstone-store@lululemon.com'), ('chanbdler-store@lululemon.com'), ('chander-store@lululemon.com'), ('chandl-store@lululemon.com'),\n('chandle-store@lululemon.com'), ('chandler_store@lululemon.com'), ('chandler-spring@lululemon.com'), ('chandler-sstore@lululemon.com'), ('chandler-store@luluemon.com'), ('chandler-store@lululemon.co'), ('chandler-store@lululemon.com'),\n('chandler-store@lululemonc.om'), ('chandler.store@lululemon.com'), ('chanlder-store@lululemon.com'), ('chapel-store@lululemon.com'), ('charleston-showroom@lululemon.com'), ('charlottesville-showroom@lululemon.com'), ('chatswoodchase-store@lululemon.com'),\n('chattanooga-showroom@lululemon.com'), ('cherrycreek-store@lululemon.com'), ('chestnuthill-store@lululemon.com'), ('chinook-store@lululemon.com'), ('chinookcentre-store@lululemon.com'), ('chjnadler-store@lululemon.com'), ('chnader-store@lululemon.com'),\n('chnadler-store@lululemon.com'), ('cincinnati-showroom@lululemon.com'), ('cityofsaskatoon'), ('clarendon-store@lululemon.com'), ('classencurve-store@lululemon.com'), ('cleveland-store@lululemon.com'), ('cloverviewplazastore@lululemon.com'),\n('coloradosprings-showroom@lululemon.com'), ('coloradospringsstore@lululemon.com'), ('coloradosprinsgsstore@lululemon.com'), ('coloradosrpingsstore@lululemon.com'), ('coquitlam-store@lululemon.com'), ('cornwallcentre-store@lululemon.com'), ('cortemadera-store@lululemon.com'),\n('cortemaderas-store@lululemon.com'), ('cottesloe-store@lululemon.com'), ('countryclubplaza-store@lululemon.com'), ('countrymart-store@lululemon.com'), ('cowhollow-store@lululemon.com'), ('crescentcourt-store@lululemon.com'), ('crocker-store@lululemon.com'),\n('crockerpark-store@lululemon.com'), ('cumberland-store@lululemon.com'), ('danbury-store@lululemon.com'), ('dd@gmail.com'), ('decline@email.com'), ('decline@gmail.com'), ('decline@lulu.com'),\n('decline@luluemon.com'), ('decline@lululemoin.com'), ('decline@lululemon.com'), ('decline@lululwmon.com'), ('decline@no.com'), ('decline@yahoo.com'), ('decline123@lululemon.com'),\n('declined@email.com'), ('declined@gmail.com'), ('declined@lululemon.com'), ('declined@me.com'), ('declined@no.com'), ('declined@noemail.com'), ('declined@yahoo.com'),\n('declined12@gmail.com'), ('declined12@no.com'), ('declined123@gmail.com'), ('declined123@gmail.cpm'), ('declined123@me.com'), ('declined123@yahoo.com'), ('declined1234@gmail.com'),\n('declined1234@me.com'), ('declined1234@yahoo.com'), ('declined1234646@yahoo.com'), ('declined1236757@me.com'), ('declined123857@gmail.com'), ('declined126@gmail.com'), ('declined1268352@me.com'),\n('declined128@yahoo.com'), ('declined13@gmail.com'), ('declined22@me.com'), ('declined23@me.com'), ('declined234@aol.com'), ('declined234@gmail.com'), ('declined234@yahoo.com'),\n('declined2345@gmail.com'), ('declined2345@me.com'), ('declined2345@yahoo.com'), ('declined23458467@me.com'), ('declined235@gmail.com'), ('declined23583246@me.com'), ('declined237@me.com'),\n('declined237456328@me.com'), ('declined237565@me.com'), ('declined238@me.com'), ('declined2437846@me.com'), ('declined2455@gmail.com'), ('declined2458573@me.com'), ('declined2468@gmail.com'),\n('declined2484673@me.com'), ('declined24869@gmail.com'), ('declined248693@gmail.com'), ('declined24895@me.com'), ('declined24957@me.com'), ('declined2748262@gmail.com'), ('declined274836@gmail.com'),\n('declined28563@me.com'), ('declined285762376@me.com'), ('declined345@me.com'), ('declined3451@me.com'), ('declined358276@me.com'), ('declined358436@me.com'), ('declined3584692@me.com'),\n('declined35876947@gmail.com'), ('declined46987034@me.com'), ('declined569846@yahoo.com'), ('declined5867649@yahoo.com'), ('declined6079847@yahoo.com'), ('declined790472351@me.com'), ('declinedemail@aol.com'),\n('declinedemail@yahoo.com'), ('deerpark-store@lululemon.com'), ('default@gmail.com'), ('delamo-store@lululemon.com'), ('desmoines-showroom@lululemon.com'), ('destin-showroom@lululemon.com'), ('destiny-store@lululemon.com'),\n('domain-store@lululemon.com'), ('doncaster-store@lululemon.com'), ('doncaster-store@lululemon.com.au'), ('east66-store@lululemon.com'), ('east66th-store@lululemon.com'), ('easthampton-store@lululemon.com'), ('eatoncenter-store@lululemon.com'),\n('eatoncentre-store@lululemon.ca'), ('eatoncentre-store@lululemon.com'), ('edinburgh-showroom@lululemon.com'), ('ee@gmail.com'), ('elpaso-showroom@lululemon.com'), ('elpasoshowroom@lululemon.com'), ('email@email.com'),\n('email@gmail.com'), ('eton-store@lululemon.com'), ('fairview-store@lululemon.com'), ('farmingtonave-store@lululemon.com'), ('fashionplace-store@lululemon.com'), ('fashionplacestore@lululemon.com'), ('fashionshow-store@lululemon.com'),\n('fashionvalley-store@lululemon.com'), ('fayettevilleshowroom@lululemon.com'), ('ff@gmail.com'), ('figgarden_store@lululemon.com'), ('firstcolony-store@lululemon.com'), ('fondren-showroom@lululemon.com'), ('fortmyers-showroom@lululemon.com'),\n('fortworth-showroom@lululemon.com'), ('fortworth-store@lululemon.com'), ('franklulu@gmail.com'), ('franklulu123@gmail.com'), ('franklulu123@lululemon.com'), ('freehold-store@lululemon.com'), ('friendlycenter-store@lululemon.com'),\n('frontenac-store@lululemon.com'), ('g@gmail.com'), ('galleriaedinastore@lululemon.com'), ('gardencity-store@lululemon.com'), ('gardens-store@lululemon.com'), ('gardenstate-store@lululemon.com'), ('gec@lululemon.com'),\n('gec@lululemon.com.au'), ('geconline@lululemon.com'), ('gecorders@lululemon.com'), ('gecreturns@lululemon.com'), ('georgetown-store@lululemon.com'), ('gg@gmail.com'), ('gilroy-outlet@lululemon.com'),\n('glendale-store@lululemon.com'), ('grandave_store@lululemon.com'), ('grandave-store@lululemon.com'), ('grandrapids-showroom@lululemon.com'), ('grantavenue-store@lululemon.com'), ('greensboro-showroom@lululemon.com'), ('greenwich-store@lululemon.com'),\n('groveatshrewsberry-store@lululemon.com'), ('groveatshrewsbury-store@lululemon.com'), ('halifax-store@lululemon.com'), ('halifaxseasonalstore@lululemon.com'), ('halsted-store@lululemon.com'), ('harboreast-store@lululemon.com'), ('harvardsquare-store@lululemon.com'),\n('harvardsquare.store@lululemon.com'), ('hh@gmail.com'), ('highlandvikllage-store@lululemon.com'), ('highlandvillage-store@lululemon.com'), ('highlandvillagestore@lululemon.com'), ('highpoint-store@lululemon.com'), ('hillcenter_store@lululemon.com'),\n('hillcenter-store@lululemon.com'), ('hilldalemall-store@lululemon.com'), ('hingham-store@lululemon.com'), ('hingham.store@lululemon.com'), ('hobart-store@lululemon.com'), ('houstoncitycentre-store@lululemon.com'), ('houstongalleria-store@lululemon.com'),\n('howellmill-store@lululemon.com'), ('huntsville-showroom@lululemon.com'), ('hydepark-showroom@lululemon.com'), ('hydeparksquar-store@lululemon.com'), ('hydeparksquare-store@lululemon.com'), ('hydeparkvillage-store@lululemon.com'), ('hylanvillage-store@lululemon.com'),\n('i@c.co'), ('i@cloud.co'), ('i@cloud.com'), ('i@co.co'), ('i@lulu.co'), ('i@lulu.com'), ('ifcstore@lululemon.com'),\n('info@lulu.co'), ('info@lulu.com'), ('info@lulu.net'), ('info@lululemon.com'), ('irvine-store@lululemon.com'), ('itstoresupport@lululemon.com'), ('ivy-store@lululemon.com'),\n('jacksonville-store@lululemon.com'), ('jamesstreet-store@lululemon.com'), ('johnson_store@lululemon.com'), ('johnson-store@lululemon.com'), ('jordancreek-store@lululemon.com'), ('kalakaua-store@lululemon.com'), ('karrinyup-store@lululemon.com'),\n('kaystone-store@lululemon.com'), ('kenwood-store@lululemon.com'), ('kenwoodstore@lululemon.com'), ('keystone-store@lululemon.com'), ('kingsroad-store@lululemon.com'), ('kingstreet-store@lululemon.com'), ('kingsway-store@lululemon.com'),\n('kitchinplace-store@lululemon.com'), ('kitchinplace-store@lululemonc.om'), ('knoxstreet-store@lululemon.com'), ('kop-store@lululemon.com'), ('lacantera-store@lululemon.com'), ('laencantada-store@lululemon.com'), ('laguna-showroom@lululemon.com'),\n('lajolla-store@lululemon.com'), ('lakeshore-store@lululemon.ca'), ('lakeshore-store@lululemon.com'), ('leawood-store@lululemon.com'), ('leawood-store@lululemon.ocm'), ('legacy-store@lululemon.com'), ('lenox-store@lululemon.com'),\n('lincolnroad-store@lululemon.com'), ('lincolnsquare-store@lululemon.com'), ('littlerock-store@lululemon.com'), ('logancircle-store@lululemon.com'), ('londonontario-store@lululemon.com'), ('lonondontario-store@lululemon.com'), ('louisville-showroom@lululemon.com'),\n('lulu@gmail.com'), ('lululemon@info.com'), ('lululemon@lululemon.com'), ('lululemonchander@lululemon.com'), ('lululemonchandler@lululemon.com'), ('lululemonspringfieldave-store@lululemon.com'), ('madisonave-store@lululemon.com'),\n('mallincolumbia-store@lululemon.com'), ('mallofamerica-store@lululemon.com'), ('malpleviewmall-store@lululemon.com'), ('manhasset-store@lululemon.com'), ('mapleview-store@lululemon.com'), ('mapleviewmall-store@lululemon.com'), ('marketmall-store@lululemon.com'),\n('marketstreet-store@lululemon.com'), ('marthasvineyardpopup@lululemon.com'), ('marylandplaza-store@lululemon.com'), ('me@me.com'), ('meatpacking-store@lululemon.com'), ('merdian-store@lululemon.com'), ('meridian-store@lululemon.com'),\n('metairie-store@lululemon.com'), ('metroton_store@lululemon.com'), ('metrotown-store@lululemon.com'), ('miamibeach-showroom@lululemon.com'), ('missionviejo-store@lululemon.com'), ('morgancrossing-store@lululemon.com'), ('mosaic-store@lululemon.com'),\n('mosman-store@lululemon.com'), ('n/a'), ('n/a@gmail.com'), ('na@gmail.com'), ('name@noname.com'), ('napa-popup@lululemon.com'), ('naples-store@lululemon.com'),\n('naples-store@lululemon.con'), ('natick-store@lululemon.com'), ('natickmall-store@lululemon.com'), ('newbury-store@lululemon.com'), ('newmarket-store@lululemon.com'), ('neworleans-showroom@lululemon.com'), ('neworleansshowroom@lululemon.com'),\n('newport_store@lululemon.com'), ('newport-popup@lululemon.com'), ('newport-store@lululemon.com'), ('newport.store@lululemon.com'), ('niagara-outlet@lululemon.com'), ('no!@no.com'), ('no.no@gmail.com'),\n('no.nol@no.com'), ('no@123.com'), ('no@aol.com'), ('no@email.com'), ('no@gmai.com'), ('no@gmail.com'), ('no@hotmail.com'),\n('no@live.com'), ('no@lululemon.com'), ('no@mail.com'), ('no@name.com'), ('no@noemail.com'), ('no@nomail.com'), ('no@thankyou.com'),\n('no@yahoo.com'), ('noeamils@yahoo.com'), ('noeemail@yahoo.com'), ('noemai@gmail.com'), ('noemai@yahoo.com'), ('noemail!@gmai.com'), ('noemail@aol.com'),\n('noemail@eamil.com'), ('noemail@email.co'), ('noemail@email.com'), ('noemail@email.cpom'), ('noemail@emaili.com'), ('noemail@emial.com'), ('noemail@gmai.com'),\n('noemail@gmaiil.com'), ('noemail@gmail.com'), ('noemail@gmail.copm'), ('noemail@gmaili.com'), ('noemail@gmal.com'), ('noemail@hotmail.ca'), ('noemail@hotmail.com'),\n('noemail@lululemon.com'), ('noemail@mail.com'), ('noemail@me.com'), ('noemail@no.com'), ('noemail@noemail.com'), ('noemail@nomail.com'), ('noemail@yaho.com'),\n('noemail@yahoo.com'), ('noemail@yahool.com'), ('noemail@yuahoo.com'), ('noemail85672@me.com'), ('noemailk@gmail.com'), ('noemails@gmail.com'), ('noemails@yahoo.com'),\n('noemaiol@yahoo.com'), ('noemal@yahoo.com'), ('noemeial@email.com'), ('noemial@email.com'), ('noemial@gmail.com'), ('nogmail@gmail.com'), ('nohotmail@hotmail.ca'),\n('noiemail@email.com'), ('noimail@hotmail.com'), ('nomail@ghotmail.com'), ('nomail@gmail.com'), ('nomail@gomail.com'), ('nomail@hjotmail.com'), ('nomail@hotmai.com'),\n('nomail@hotmail.com'), ('nomail@hotmazil.com'), ('nomail@hotymail.com'), ('nomail@mail.com'), ('nomasil@hotmasil.com'), ('nomemail@gmail.com'), ('non@none.com'),\n('noname@gmail.com'), ('noname@hotmail.com'), ('noname@no.com'), ('noname@noname.com'), ('none.none@yahoo.com'), ('none@aol.com'), ('none@email.com'),\n('none@gmail.com'), ('none@no.com'), ('none@noe.com'), ('none@non.com'), ('none@none.com'), ('none@none.come'), ('none@yahoo.com'),\n('nope@gmail.com'), ('nope@yahoo.com'), ('noreceipt@noreceipt.com'), ('noreceipt@norecipt.com'), ('norecipt@yahoo.com'), ('noreply@apple.com'), ('noreplyever@refused.com'),\n('northbeverly-store@lululemon.com'), ('northbeverly-store@lululemon.comm'), ('northbrook-store@lululemon.com'), ('northhills-stores@lululemon.com'), ('northpark-store@lululemon.com'), ('nothank@gmal.com'), ('nothanks@gmail.com'),\n('nothanks@yahoo.com'), ('nothannks@gmail.com'), ('oakbrook-store@lululemon.com'), ('oakridge_store@lululemon.com'), ('oakridge-store@lululemon.com'), ('oldorchard-store@lululemon.com'), ('oldorchard=store@lululemon.com'),\n('oldtown-store@lululemon.com'), ('oldwoodwardave-store@lululemon.com'), ('omaha-showroom@lululemon.com'), ('online@lululemon.com'), ('optout@optout.com'), ('oshawa-store@lululemon.com'), ('owasha-store@lululemon.com'),\n('oxmoorcenter-store@lululemon.com'), ('pacificplace-store@lululemon.com'), ('palmdesert-store@lululemon.com'), ('paloalto-store@lululemon.com'), ('parkcity-store@lululemon.com'), ('parkmeadows-store@lululemon.com'), ('parkroyal-store@lululemon.com'),\n('pasadena-store@lululemon.com'), ('pearl-store@lululemon.com'), ('perimeter-store@lululemon.com'), ('perth-store@lululemon.com'), ('placestefoy-store@lululemon.com'), ('plazaelsegundo_store@lululemon.com'), ('plazaelsegundo-store@lululemon.com'),\n('polaris-store@lululemon.com'), ('polopark-store@lululemon.com'), ('portland-showroom@lululemon.com'), ('portsmouth-showroom@lululemon.com'), ('princess-store@lululemon.com'), ('princeton-store@lululemon.com'), ('promenade-store@lululemon.com'),\n('providence-showroom@lululemon.com'), ('prudential-store@lululemon.com'), ('quarry-store@lululemon.com'), ('quartierdix30-store@lululemon.com'), ('queen-store@lululemon.com'), ('raleigh-showroom@lululemon.com'), ('ranchocucamonga-showroom@lululemon.com'),\n('refused@lululemon.com'), ('regalia-store@lululemon.com'), ('richmondcentre-store@lululemon.com'), ('richmondthames-store@lululemon.com'), ('rideau-store@lululemon.com'), ('robertson-store@lululemon.com'), ('robina-store@lululemon.com'),\n('robson-store@lululemon.com'), ('roosevelt-store@lululemon.com'), ('rooseveltfield-store@lululemon.com'), ('roseville-store@lululemon.com'), ('rossparkmall-store@lululemon.com'), ('rush-store@lululemon.com'), ('sagemore-store@lululemon.com'),\n('sanclemente-showroom@lululemon.com'), ('santabarbara-store@lululemon.com'), ('santamonica-store@lululemon.com'), ('sarasota-store@lululemon.com'), ('saskatoon-store@lululemon.com'), ('savannah-showroom@lululemon.com'), ('scarborough-store@lululemon.com'),\n('scottsdale-store@lululemon.com'), ('scottsdalefs-store@lululemon.com'), ('scottsdalefsstore@lululemon.com'), ('scottsdalesfstore@lululemon.com'), ('sfs-store@lululemon.com'), ('shadyside-store@lululemon.com'), ('shadyside-store@lululemon.comm'),\n('shc-showroom@lululemon.com'), ('sherway-store@lululemon.com'), ('shopsatcanalplace-store@lululemon.com'), ('shopsatlegacy-store@lululemon.com'), ('shorthills-store@lululemon.com'), ('shortpump-store@lululemon.com'), ('soho-store@lululemon.com'),\n('sohobroadway-store@lululemon.com'), ('somerset-store@lululemon.com'), ('sorrento-showroom@lululemon.com'), ('southcentre-store@lululemon.com'), ('southcoast-store@lululemon.com'), ('southlake-store@lululemon.com'), ('southmiami-store@lululemon.com'),\n('southpark-store@lululemon.com'), ('southport-store@lululemon.com'), ('southside-store@lululemon.com'), ('springfieldave-store@lululemon.com'), ('squareone-store@lululemon.com'), ('stationpark-store@lululemon.com'), ('stcatherine-store@lululemon.com'),\n('stdenis-store@lululemon.com'), ('stecatherine-store@lululemon.com'), ('stoneridgemall-store@lululemon.com'), ('store-chandler@lululemon.com'), ('store-chestnuthill@lululemon.com'), ('store@lululemon.com'), ('stpetersburgshowroom@lululemon.com'),\n('streetsatsouthpoint-store@lululemon.com'), ('studiocity-store@lululemon.com'), ('suburbansquare-store@lululemon.com'), ('summerlin-showroom@lululemon.com'), ('sunvalley-showroom@lululemon.com'), ('syracuse-showroom@lululemon.com'), ('syracuse-showroom@lululemon.con'),\n('tallahasse-showroom@lululemon.com'), ('tallahassee-showroom@lululemon.com'), ('talllahassee-showroom@lululemon.com'), ('teamprogram@lululemon.com'), ('temp@lululemon.com'), ('test@test.ca'), ('thegroveatshrewsbury-store@lululemon.com'),\n('thirdward-store@lululemon.com'), ('toledo-showroom@lululemon.com'), ('trolleysquare-store@lululemon.com'), ('tsimshatsui-showroom@lululemon.com'), ('tucson-showroom@lululemon.com'), ('twelveoaks-store@lululemon.com'), ('unionsquarenyc-store@lululemon.com'),\n('unknown@yahoo.com'), ('vail-showroom@lululemon.com'), ('vailvillage-store@lululemon.com'), ('valencia-store@lululemon.com'), ('vaughan-store@lululemon.com'), ('villagepointe-store@lululemon.com'), ('virginiabeach-store@lululemon.com'),\n('waldengalleria-store@lululemon.com'), ('walnutcreek-store@lululemon.com'), ('walnutstreet-store@lululemon.com'), ('waltwhitman-store@lululemon.com'), ('wayne-store@lululemon.com'), ('weatfieldutc-store@lululemon.com'), ('west4th-store@lululemon.com'),\n('westboro-store@lululemon.com'), ('westedmall-store@lululemon.com'), ('westend-store@lululemon.com'), ('westfarmsmall-store@lululemon.com'), ('westfieldmall-store@lululemon.com'), ('westfieldutc-store@lululemon.com'), ('westgate-outlet@lululemon.com'),\n('westlake-store@lululemon.com'), ('westmount-store@lululemon.com'), ('westport-store@lululemon.com'), ('whistler-store@lululemon.com'), ('whiteplains-store@lululemon.com'), ('whyte-store@lululemon.com'), ('winterpark-store@lululemon.co');\n\nINSERT OVERWRITE INTO delta_stage_customer (${columns:customer::%1$s})\nSELECT ${columns:customer::c3.%1$s AS %1$s}\nFROM (\n    SELECT ${columns:customer:~Email,PrimaryPhone,MobilePhone,FirstName,LastName,c_researchDev,c_scStatus,SourceCustomerNumber:c2.%1$s AS %1$s}\n        , CASE\n            WHEN POSITION('@' IN LOWER(c2.Email)) = 0\n\t\t\tOR tie.email is not null\n                OR c2.Email LIKE '@%'\n                OR LENGTH(c2.Email) > 100\n            THEN NULL\n            ELSE c2.Email\n          END\n          AS Email\n\n        , CASE WHEN DW.FIND_IN_SET(PrimaryPhone, $PhoneList) > 0\n                OR LENGTH(PrimaryPhone) < 10\n                OR LENGTH(PrimaryPhone) > 13\n            THEN NULL\n            ELSE PrimaryPhone\n          END\n          AS PrimaryPhone\n\n        , CASE WHEN DW.FIND_IN_SET(MobilePhone, $PhoneList) > 0\n                OR LENGTH(MobilePhone) < 10\n                OR LENGTH(MobilePhone) > 13\n            THEN NULL\n            ELSE MobilePhone\n          END\n          AS MobilePhone\n        ,CASE WHEN DW.FIND_IN_SET(LOWER(c2.FirstName), $NamesList) > 0\n                OR DW.FIND_IN_SET(LOWER(CONCAT(c2.FirstName, c2.LastName)), $NamesList) > 0\n                OR c2.FirstName NOT RLIKE '.*[A-Za-z].*'\n            THEN NULL\n            ELSE INITCAP(c2.FirstName)\n            END AS FirstName\n        ,CASE\n            WHEN DW.FIND_IN_SET(LOWER(c2.LastName), $NamesList) > 0\n                OR DW.FIND_IN_SET(LOWER(CONCAT(c2.FirstName, c2.LastName)), $NamesList) > 0\n                OR COALESCE(c2.LastName,'') NOT RLIKE '.*[A-Za-z].*'\n            THEN NULL\n            ELSE INITCAP(c2.LastName)\n            END AS LastName\n        ,c_researchdev\n        ,c_scStatus\n        ,CASE\n            WHEN COALESCE(LOWER(c2.SourceCustomerNumber),'') LIKE '%@%'\n            THEN SHA2_HEX(LOWER(TRIM(c2.SourceCustomerNumber)))\n            ELSE  c2.SourceCustomerNumber\n          END AS SourceCustomerNumber\n    FROM (\n        SELECT ${columns:customer:~PrimaryPhone,MobilePhone,FirstName,LastName,c_researchDev,c_scStatus:c.%1$s AS %1$s}\n            , REGEXP_REPLACE(COALESCE(PrimaryPhone, ''), '[^0-9]+', '') AS PrimaryPhone\n            , REGEXP_REPLACE(COALESCE(MobilePhone, ''), '[^0-9]+', '') AS MobilePhone\n            , COALESCE(REGEXP_REPLACE(FirstName,'\\\\s',''),'') AS FirstName\n            , COALESCE(REGEXP_REPLACE(LastName,'\\\\s',''),'') AS LastName\n            ,CASE WHEN COALESCE(LOWER(Source),'') LIKE 'customer%'\n                THEN CASE WHEN COALESCE(UPPER(c_guestType),'') LIKE '%R&D%' THEN '1' ELSE '0' END\n                ELSE NULL\n                END AS c_researchdev\n            ,CASE WHEN COALESCE(LOWER(Source),'') LIKE 'customer%'\n                THEN CASE WHEN COALESCE(UPPER(c_guestType),'') LIKE '%SWEAT_COLLECTIVE%' THEN '1' ELSE '0' END\n                ELSE NULL\n                END AS c_scStatus\n        FROM delta_udm_customer c\n        WHERE COALESCE(c.SourceCustomerNumber,'') <> ''\n    ) c2 left outer join tmp_invalid_emails tie on (tie.email = c2.Email)\n) c3\n;", '/Users/shashank.singh/Documents/mycode/PolarisEAP/AUTODEPLOY/SF_DW_MAPPER_DEFAULT/sf_dw_customer/sf_dw_customer_POST_600.sql': "INSERT OVERWRITE INTO delta_stage_customer (${columns:customer::%1$s})\n\nSELECT\n\t${columns:customer::c.%1$s AS %1$s}\nFROM (\n\tSELECT ${columns:customer:~c_emailHash:c.%1$s AS %1$s}\n\t\t,CASE WHEN COALESCE(TRIM(Email), '') <> '' THEN SHA2_HEX(LOWER(TRIM(Email)))\n           ELSE c_emailHash\n           END AS c_emailHash\n\tFROM delta_udm_customer c\n) c\n;", '/Users/shashank.singh/Documents/mycode/PolarisEAP/AUTODEPLOY/SF_DW_MAPPER_DEFAULT/sf_dw_customer/sf_dw_customer_PRE_440.sql': "SET GuestCheckoutSource = 'GuestCheckout';\n/*\nBacktrack emails of ATG and SFCC customers\n*/\ncreate or replace temporary table tbl_temporary_backtrack_email as\nSELECT c.SourceCustomerNumber AS SourceCustomerNumber\n    , c.c_lululemonSource AS c_lululemonSource\n    , SUBSTRING(MAX(CONCAT(TO_NUMBER_CUSTOM(c.RowModified), CASE WHEN COALESCE(c.email, '') = '' THEN NULL ELSE c.email END)), 14) AS email\nFROM (\n    SELECT sc.SourceCustomerNumber AS SourceCustomerNumber\n        , sc.email AS email\n        , sc.c_lululemonSource AS c_lululemonSource\n        , sc.RowModified AS RowModified\n    FROM delta_udm_customer sc\n    WHERE sc.c_lululemonsource IN ('ATG', 'SFCC')\n\n    UNION ALL\n\n    SELECT c.SourceCustomerNumber AS SourceCustomerNumber\n        , c.email AS email\n        , c.c_lululemonSource AS c_lululemonSource\n        , c.RowModified AS RowModified\n    FROM PUBLIC.customer c\n    WHERE c.c_lululemonsource IN ('ATG', 'SFCC')\n) c\nGROUP BY c.SourceCustomerNumber, c.c_lululemonSource;\n\nINSERT OVERWRITE INTO delta_stage_customer (${columns:customer::%1$s})\nwith ftp_csv_1_source as\n(\nSELECT * FROM delta_udm_customer sc\nWHERE COALESCE(sc.c_lululemonSource, '') = ''\nAND COALESCE(sc.sourcesystemid, '') = 'FTP_CSV_1'\n)\nSELECT ${columns:customer::c.%1$s AS %1$s}\nFROM (\n    SELECT ${columns:customer:~Email,c_lululemonSource,RowModified:stc.%1$s AS %1$s}\n        , CASE\n            WHEN COALESCE(c.SourceCustomerNumber, '') <> '' THEN c.Email\n            WHEN COALESCE(stc.Email, '') = '' THEN NULL\n            ELSE stc.Email\n        END AS Email\n        , CASE\n            WHEN COALESCE(c.SourceCustomerNumber, '') <> '' THEN c.c_lululemonSource\n            ELSE $GuestCheckoutSource\n        END AS c_lululemonSource\n        , stc.RowModified AS RowModified\n    FROM ftp_csv_1_source stc\n    LEFT OUTER JOIN tbl_temporary_backtrack_email c\n        ON stc.SourceCustomerNumber = c.SourceCustomerNumber\n\n    UNION ALL\n\n    SELECT ${columns:customer:~Email,c_lululemonSource,RowModified:sc.%1$s AS %1$s}\n        , sc.Email AS Email\n        , sc.c_lululemonSource AS c_lululemonSource\n        , DATEADD(second, 1, sc.RowModified) AS RowModified\n    FROM delta_udm_customer sc\n    LEFT OUTER JOIN ftp_csv_1_source stc on stc.SourceCustomerNumber = sc.SourceCustomerNumber\n    WHERE stc.SourceCustomerNumber is null\n) c\n;"}}